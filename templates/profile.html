<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">

    <!-- PWA -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <meta name="theme-color" content="#1e3a8a">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='icons/icon-192.png') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <title>Meu Perfil - MOB</title>
</head>

<body class="bg-gray-50 pb-24">

    <!-- Header Simples -->
    <header class="bg-white p-4 shadow-sm flex items-center gap-4">
        <a href="/dashboard" class="text-blue-600">
            <i class="fas fa-arrow-left text-xl"></i>
        </a>
        <h1 class="text-xl font-bold text-blue-900">
            Configurações de Perfil
        </h1>
    </header>

    <main class="max-w-md mx-auto p-4 space-y-6">

        <!-- Seção: Meus Dados -->
        <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
            <h3 class="font-bold text-gray-700 mb-4 flex items-center gap-2">
                <i class="fas fa-user-edit text-blue-500"></i>
                Atualizar Dados
            </h3>

            <form action="/update_profile" method="POST" class="space-y-4">
                <input type="text"
                       name="name"
                       value="{{ current_user.name }}"
                       class="w-full p-4 bg-gray-50 rounded-2xl outline-none ring-1 ring-gray-200 focus:ring-2 focus:ring-blue-500">

                <input type="text"
                       name="whatsapp"
                       value="{{ current_user.whatsapp }}"
                       class="w-full p-4 bg-gray-50 rounded-2xl outline-none ring-1 ring-gray-200 focus:ring-2 focus:ring-blue-500">

                <button type="submit"
                        class="w-full bg-blue-100 text-blue-700 py-3 rounded-2xl font-bold">
                    Salvar Alterações
                </button>
            </form>
        </div>

        <!-- Seção: Alterar Senha -->
        <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-100">
            <h3 class="font-bold text-gray-700 mb-4 flex items-center gap-2">
                <i class="fas fa-lock text-red-500"></i>
                Redefinir Senha
            </h3>

            <form action="/change_password" method="POST" class="space-y-4">
                <input type="password"
                       name="old_password"
                       placeholder="Senha Atual"
                       class="w-full p-4 bg-gray-50 rounded-2xl outline-none ring-1 ring-gray-200 focus:ring-2 focus:ring-blue-500">

                <input type="password"
                       name="new_password"
                       placeholder="Nova Senha"
                       class="w-full p-4 bg-gray-50 rounded-2xl outline-none ring-1 ring-gray-200 focus:ring-2 focus:ring-blue-500">

                <button type="submit"
                        class="w-full bg-red-50 text-red-600 py-3 rounded-2xl font-bold">
                    Alterar Senha
                </button>
            </form>
        </div>

        <a href="/logout"
           class="block w-full text-center py-4 text-gray-400 font-medium">
           Sair da conta
        </a>

    </main>

    <!-- Service Worker -->
    <script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('{{ url_for("static", filename="sw.js") }}')
            .then(() => console.log('Service Worker registrado'))
            .catch(err => console.log('Erro no SW:', err));
    }
    </script>

</body>
</html>